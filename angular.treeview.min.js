/*
	@license Angular Treeview version 0.1.6
	â“’ 2013 AHN JAE-HA http://github.com/eu81273/angular.treeview
	License: MIT
*/

(function(angular){angular.module("angularTreeview",[]).directive("treeModel",["$compile","$timeout",function($compile,$timeout){return{restrict:"A",link:function(scope,element,attrs){var open=false;var treeId=attrs.treeId;if(treeId=="search"){open=true}var treeModel=attrs.treeModel;var nodeId=attrs.nodeId||"id";var nodeLabel=attrs.nodeLabel||"label";var nodeChildren=attrs.nodeChildren||"children";var clickFlag=false;var template="<ul>"+'<li data-ng-repeat="node in '+treeModel+'" data-role-id="{{node.id}}" ng-class="{true: \'pro\', false: \'pub\'}[node.permission]">'+'<i class="collapsed" data-ng-show="(node.isParent && !node.collapsed) && (!node.isMath && node.isParent)" data-ng-click="'+treeId+'.selectNodeLabel(node)"></i>'+'<i class="expanded" data-ng-show="(node.isParent && node.collapsed) || (node.isMath && node.isParent)" data-ng-click="'+treeId+'.selectNodeLabel(node)"></i>'+'<i class="normal" data-ng-hide="node.isParent"></i> '+'<span data-ng-class="node.selected" data-ng-click="'+treeId+'.selectNodeLabel(node)">{{node.'+nodeLabel+"}}</span>"+'<div data-ng-show="node.collapsed || node.isMath" data-tree-id="'+treeId+'" data-tree-model="node.'+nodeChildren+'" data-node-id='+nodeId+" data-node-label="+nodeLabel+" data-node-children="+nodeChildren+"></div>"+"</li>"+"</ul>";var template_search="<ul>"+'<li data-ng-repeat="node in '+treeModel+'">'+'<i class="collapsed" data-ng-show="node.'+nodeChildren+'.length && node.collapsed" data-ng-click="'+treeId+'.selectNodeLabel(node)"></i>'+'<i class="expanded" data-ng-show="node.'+nodeChildren+'.length && !node.collapsed" data-ng-click="'+treeId+'.selectNodeLabel(node)"></i>'+'<i class="normal" data-ng-hide="node.'+nodeChildren+'.length"></i> '+'<span data-ng-class="node.selected" data-ng-click="'+treeId+'.selectNodeLabel(node)">{{node.'+nodeLabel+"}}</span>"+'<div data-ng-hide="node.collapsed" data-tree-id="'+treeId+'" data-tree-model="node.'+nodeChildren+'" data-node-id='+nodeId+" data-node-label="+nodeLabel+" data-node-children="+nodeChildren+"></div>"+"</li>"+"</ul>";if(treeId&&treeModel){if(attrs.angularTreeview){scope[treeId]=scope[treeId]||{};scope[treeId].selectNodeHead=scope[treeId].selectNodeHead||function(selectedNode){selectedNode.collapsed=!selectedNode.collapsed};scope[treeId].selectNodeLabel=scope[treeId].selectNodeLabel||function(selectedNode){selectedNode.collapsed=!selectedNode.collapsed;if(scope[treeId].currentNode&&scope[treeId].currentNode.selected){scope[treeId].currentNode.selected=undefined}selectedNode.selected="selected";if(scope[clickFlag]){scope[treeId].dbClickFlag=true;scope[clickFlag]=false;scope[treeId].currentNode=selectedNode;return}scope[clickFlag]=true;$timeout(function(){if(scope[clickFlag]){scope[treeId].dbClickFlag=false;scope[clickFlag]=false;scope[treeId].currentNode=selectedNode}},300)}}if(open){element.html("").append($compile(template_search)(scope))}else{element.html("").append($compile(template)(scope))}}}}}])})(angular);
